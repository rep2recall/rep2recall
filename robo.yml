# Commands

docker-build:
  command: |
    docker build \
      -t {{.docker.tag}} \
      --build-arg FIREBASE_CONFIG --build-arg BASE_URL \
      .
docker-start:
  command: |
    docker run \
      -p 8080:8080 \
      -e MONGO_URI -e SECRET -e FIREBASE_SDK -e FIREBASE_CONFIG -e BASE_URL \
      {{.docker.tag}} 
docker-deploy:
  command: |
    docker push {{.docker.tag}}
dev:
  command: |
    concurrently \
      'cd submodules/web-server && yarn dev' \
      'cd submodules/web-frontend && yarn dev'
heroku-token:
  command: |
    heroku auth:token
heroku-docker-login:
  command: |
    docker login --username=_ --password=${HEROKU_TOKEN} registry.heroku.com
heroku-release:
  command: |
    heroku container:release web

##########
# Settings

variables:
  docker:
    tag: ${DOCKER_TAG:-rep2recall}
