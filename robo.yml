# Commands

install:
  command: |
    cd packages/server
    yarn
    yarn s:build
    cd -

    cd packages/web
    yarn
    yarn build
build:
  command: |
    podman-compose build
start:
  command: |
    podman-compose build
    mkdir -p mongo-data

    handler() {
      podman-compose down
    }

    trap handler SIGINT

    podman-compose up 1>/dev/null
deploy:
  command: |
    podman push patarapolw/rep2recall
dev:
  command: |
    export MONGO_URI=mongodb://localhost:27017/rep2recall

    cd packages/server
    rm -rf ./public
    pnpx concurrently \
      'cd ../web && yarn s:watch' \
      'pnpx wait-on ./public && yarn dev'
db:
  command: |
    podman-compose up mongo
